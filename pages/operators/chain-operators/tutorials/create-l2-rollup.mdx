---
title: Creating your own L2 rollup testnet
description: Learn how to orchestrate and integrate all OP Stack components for a complete testnet deployment.
lang: en-US
content_type: tutorial
topic: creating-your-own-l2-rollup-testnet
personas:
  - chain-operator
categories:
  - testnet
  - chain-deployment
  - op-deployer
  - sequencer
  - batcher
  - proposer
  - challenger
  - integration
is_imported_content: 'false'
---

import { Callout, Card, Steps } from 'nextra/components'

# Creating your own L2 rollup testnet

This tutorial focuses on **orchestrating and integrating** all OP Stack components for a complete testnet deployment. Rather than repeating component-specific installation details, this guide emphasizes the unique challenges of getting all components working together seamlessly.

## What you'll deploy

This tutorial will guide you through setting up:

1.  **L1 Smart Contracts** - The core contracts on Sepolia testnet
2.  **Execution Client** (op-geth) - Processes transactions and maintains state
3.  **Consensus Client** (op-node) - Manages rollup consensus and L1 synchronization
4.  **Batcher** (op-batcher) - Publishes transaction data to L1
5.  **Proposer** (op-proposer) - Submits state root proposals to L1
6.  **Challenger** (op-challenger) - Monitors and disputes invalid state roots

<Callout type="warning">
This guide is for **testnet deployment only**. Never use the generated keys or configurations in production environments.
</Callout>

## Prerequisites

### Component Installation

This tutorial requires several OP Stack components. Install them using the specialized guides:

| Component | Installation Guide | Purpose |
|-----------|-------------------|---------|
| **op-deployer** | [Installation Guide](/operators/chain-operators/tools/op-deployer#installation) | Smart contract deployment |
| **op-geth** | [Build Guide](/operators/chain-operators/deploy/sequencer-node#building-op-geth) | Execution client |
| **op-node** | [Build Guide](/operators/chain-operators/deploy/sequencer-node#building-optimism-components) | Consensus client |
| **op-batcher** | [Build Guide](/operators/chain-operators/deploy/spin-batcher#build-the-software) | Transaction batching |
| **op-proposer** | [Build Guide](/operators/chain-operators/deploy/proposer-setup-guide#building-the-proposer) | State root proposals |
| **op-challenger** | [Build Guide](/operators/chain-operators/tools/op-challenger#build-the-executable) | Dispute monitoring |

### Testnet Requirements

For this tutorial, you'll need:

*   **Sepolia RPC URL** - Get from [Alchemy](https://www.alchemy.com/), [Infura](https://infura.io/), or [QuickNode](https://www.quicknode.com/)
*   **Sepolia ETH** - Get from [Superchain Faucet](https://console.optimism.io/faucet) (~2-3 ETH recommended)
*   **Private Keys** - For deployer, admin, batcher, proposer, and sequencer roles (5 separate keys)

<Callout type="warning">
**Security Note**: Never use testnet private keys in production. Generate fresh keys for mainnet deployments.
</Callout>

## Step 1: Verify Component Installation

Before starting the deployment, verify all required components are properly installed:

<Steps>

### Verify installations

```bash
# Verify all components are available
op-deployer --version
op-geth version  
op-node --version
op-batcher --version
op-proposer --version
op-challenger --version
```

If any component is missing, install it using the links in the [Prerequisites](#prerequisites) section.

### Set up workspace

Create and organize your deployment workspace:

```bash
mkdir testnet-rollup && cd testnet-rollup
mkdir -p .deployer logs data components
```

</Steps>

## Step 2: Initialize deployment configuration

<Steps>

### Set network parameters

```bash
# Sepolia L1 chain ID
export L1_CHAIN_ID=11155111
# Your custom L2 chain ID (choose any unique number)
export L2_CHAIN_ID=42069
```

### Initialize deployment workspace

```bash
./op-deployer init --l1-chain-id $L1_CHAIN_ID --l2-chain-ids $L2_CHAIN_ID --workdir .deployer
```

This creates a `.deployer` directory with initial configuration files.

### Configure deployment intent

Edit the generated intent file to specify your deployment parameters:

```bash
# Edit the intent file with your preferred text editor
# For example: nano, vim, code, or any text editor
nano .deployer/intent.toml
```

Update the `[[chains]]` section with your wallet addresses and preferences. For detailed configuration options, see the [op-deployer configuration guide](/operators/chain-operators/tools/op-deployer#configuration).

</Steps>

## Step 3: Deploy L1 Smart Contracts

Deploy the L1 smart contracts and generate chain artifacts:

<Steps>

### Quick deployment

```bash
# Set deployment parameters
export L1_RPC_URL="https://eth-sepolia.g.alchemy.com/v2/YOUR_API_KEY"  
export DEPLOYER_PRIVATE_KEY="0xYOUR_PRIVATE_KEY"

# Deploy contracts and generate artifacts
op-deployer apply --workdir .deployer --l1-rpc-url $L1_RPC_URL --private-key $DEPLOYER_PRIVATE_KEY
op-deployer inspect genesis --workdir .deployer $L2_CHAIN_ID > .deployer/genesis.json
op-deployer inspect rollup --workdir .deployer $L2_CHAIN_ID > .deployer/rollup.json  
op-deployer inspect l1 --workdir .deployer $L2_CHAIN_ID > .deployer/l1-contracts.json
```

### Verify deployment

```bash
# Check that all artifacts were generated
ls -la .deployer/
# Should show: genesis.json, rollup.json, l1-contracts.json, state.json
```

</Steps>

**For detailed contract deployment and configuration**: [Smart Contract Deployment Guide](/operators/chain-operators/deploy/smart-contracts)

## Step 4: Environment Setup and Configuration

Set up the runtime environment and configuration files for component integration:

<Steps>

### Generate JWT secret

Create a shared JWT secret for op-geth and op-node authentication:

```bash
# Generate JWT secret
openssl rand -hex 32 > jwt.txt
echo "JWT secret generated: jwt.txt"
```

### Set up environment variables

Configure environment variables for all components:

```bash
# L1 and L2 configuration
export L1_CHAIN_ID=11155111
export L2_CHAIN_ID=42069
export L1_RPC_URL="https://eth-sepolia.g.alchemy.com/v2/YOUR_API_KEY"
export L1_BEACON_URL="https://ethereum-sepolia-beacon-api.publicnode.com"
export L1_RPC_KIND="alchemy"

# Component private keys (use different keys for each role)
export GS_SEQUENCER_PRIVATE_KEY="0xYOUR_SEQUENCER_PRIVATE_KEY"
export GS_BATCHER_PRIVATE_KEY="0xYOUR_BATCHER_PRIVATE_KEY"  
export GS_PROPOSER_PRIVATE_KEY="0xYOUR_PROPOSER_PRIVATE_KEY"
export GS_CHALLENGER_PRIVATE_KEY="0xYOUR_CHALLENGER_PRIVATE_KEY"

# Extract contract addresses from deployment
export OP_PROPOSER_GAME_FACTORY_ADDRESS=$(cat .deployer/l1-contracts.json | jq -r .opChainDeployment.disputeGameFactoryProxyAddress)
```

### Organize configuration files

```bash
# Copy configuration files to accessible locations
cp .deployer/genesis.json ./genesis.json
cp .deployer/rollup.json ./rollup.json
cp jwt.txt ./jwt.txt
```

</Steps>

**For detailed component building**: See individual component guides in [Prerequisites](#prerequisites)

## Step 5: Start op-geth (Execution Layer)

**Start components in order**: op-geth must be running before starting op-node.

<Steps>

### Initialize op-geth

```bash
# Initialize the data directory
mkdir -p data/geth
op-geth init --state.scheme=hash --datadir=data/geth genesis.json
```

### Start op-geth

```bash
# Start in a new terminal window
op-geth \
  --datadir=./op-geth-data \
  --http \
  --http.addr=0.0.0.0 \
  --http.port=$OP_GETH_HTTP_PORT \
  --http.vhosts="*" \
  --http.corsdomain="*" \
  --http.api=eth,net,web3,debug,txpool,admin \
  --ws \
  --ws.addr=0.0.0.0 \
  --ws.port=$OP_GETH_WS_PORT \
  --ws.origins="*" \
  --ws.api=eth,net,web3,debug,txpool,admin \
  --authrpc.addr=0.0.0.0 \
  --authrpc.port=$OP_GETH_AUTH_PORT \
  --authrpc.vhosts="*" \
  --authrpc.jwtsecret=$JWT_SECRET \
  --syncmode=full \
  --gcmode=archive \
  --rollup.disabletxpoolgossip=true \
  --rollup.sequencerhttp=http://localhost:$OP_NODE_RPC_PORT
```

### Verify op-geth is running

```bash
# Check if op-geth is responding (wait ~30 seconds after startup)
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' \
  http://localhost:8545

# Should return: {"jsonrpc":"2.0","id":1,"result":"0x0"}
```

</Steps>

**For detailed op-geth configuration**: [Sequencer Node Setup](/operators/chain-operators/deploy/sequencer-node)

## Step 6: Start op-node (Consensus Layer)

**Prerequisite**: op-geth must be running and verified before starting op-node.

<Steps>

### Start op-node

```bash
# Start in a new terminal window (ensure op-geth is running first)
op-node \
  --l2=http://localhost:8551 \
  --l2.jwt-secret=./jwt.txt \
  --sequencer.enabled \
  --sequencer.l1-confs=5 \
  --verifier.l1-confs=4 \
  --rollup.config=./rollup.json \
  --rpc.addr=0.0.0.0 --rpc.port=9545 \
  --p2p.disable \
  --rpc.enable-admin \
  --p2p.sequencer.key=$GS_SEQUENCER_PRIVATE_KEY \
  --l1=$L1_RPC_URL \
  --l1.rpckind=$L1_RPC_KIND \
  --l1.beacon=$L1_BEACON_URL
```

### Verify op-node sync

```bash
# Check op-node status (wait ~1 minute after startup)  
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"optimism_syncStatus","params":[],"id":1}' \
  http://localhost:9545

# Verify L2 block production
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' \
  http://localhost:8545
```

</Steps>

**For detailed op-node configuration**: [Sequencer Node Setup](/operators/chain-operators/deploy/sequencer-node)

## Step 7: Start op-batcher (Data Publishing)

**Prerequisite**: Both op-geth and op-node must be running and synced.

<Steps>

### Start op-batcher

```bash
# Start in a new terminal window
op-batcher \
  --l2-eth-rpc=http://localhost:8545 \
  --rollup-rpc=http://localhost:9545 \
  --poll-interval=1s \
  --sub-safety-margin=6 \
  --num-confirmations=1 \
  --safe-abort-nonce-too-low-count=3 \
  --resubmission-timeout=30s \
  --rpc.addr=0.0.0.0 --rpc.port=8548 \
  --rpc.enable-admin \
  --max-channel-duration=25 \
  --l1-eth-rpc=$L1_RPC_URL \
  --private-key=$GS_BATCHER_PRIVATE_KEY
```

### Verify op-batcher

```bash
# Check batcher health (wait ~2 minutes after startup)
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"admin_nodeInfo","params":[],"id":1}' \
  http://localhost:8548

# Monitor for batch submissions in batcher logs
# Look for: "batch submitted successfully" or "published transaction"
```

</Steps>

**For detailed batcher configuration**: [op-batcher Deployment Guide](/operators/chain-operators/deploy/spin-batcher)

## Step 8: Start op-proposer (State Root Proposals)

**Prerequisite**: All previous components must be running and healthy.

<Steps>

### Start op-proposer

```bash
# Start in a new terminal window
op-proposer \
  --poll-interval=12s \
  --rpc.port=8560 \
  --rollup-rpc=http://localhost:9545 \
  --game-factory-address=$OP_PROPOSER_GAME_FACTORY_ADDRESS \
  --proposal-interval=4m \
  --game-type=1 \
  --private-key=$GS_PROPOSER_PRIVATE_KEY \
  --l1-eth-rpc=$L1_RPC_URL
```

### Verify op-proposer

```bash
# Check proposer health (wait ~1 minute after startup)
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"admin_nodeInfo","params":[],"id":1}' \
  http://localhost:8560

# Monitor for state root proposals in proposer logs  
# Look for: "state update proposal confirmed" or "proposal submitted"
```

</Steps>

**For detailed proposer configuration**: [op-proposer Deployment Guide](/operators/chain-operators/deploy/proposer-setup-guide)

## Step 9: Start op-challenger (Dispute Monitoring)

**Prerequisite**: All other components must be running and proposing state roots.

<Steps>

### Start op-challenger

```bash
# Start in a new terminal window
mkdir -p data/challenger
op-challenger \
  --trace-type=permissioned,cannon \
  --l1-eth-rpc=$L1_RPC_URL \
  --l2-eth-rpc=http://localhost:8545 \
  --rollup-rpc=http://localhost:9545 \
  --private-key=$GS_CHALLENGER_PRIVATE_KEY \
  --network=op-sepolia \
  --datadir=./data/challenger
```

### Verify op-challenger

```bash
# Check challenger health (wait ~1 minute after startup)
# Challenger doesn't have an RPC endpoint, monitor logs for:
# "monitoring dispute games" or "challenger started successfully"

# Verify challenger is monitoring the game factory
echo "Monitor challenger logs for dispute game monitoring messages"
```

</Steps>

**For detailed challenger configuration**: [op-challenger Configuration Guide](/operators/chain-operators/tools/op-challenger)

### Configure dispute resolution (Optional)

```bash
# Get the Game Factory address for manual configuration
echo "Game Factory Address: $OP_PROPOSER_GAME_FACTORY_ADDRESS"
echo "Visit: https://sepolia.etherscan.io/address/$OP_PROPOSER_GAME_FACTORY_ADDRESS#writeProxyContract"
echo "Call setInitBond with _gameType: 1, _initBond: 800000000000000"
```


## Troubleshooting

Common integration issues and solutions:

<Callout>
**Component Dependencies**: Always start components in order: op-geth → op-node → op-batcher → op-proposer → op-challenger
</Callout>

### Common Issues

| Problem | Symptom | Solution |
|---------|---------|----------|
| **op-node won't sync** | "connection refused" errors | Verify op-geth is running and JWT secret matches |
| **Batcher not submitting** | No batch submissions in logs | Check L1 RPC connection and batcher private key has ETH |
| **Proposer not proposing** | No state root proposals | Verify rollup-rpc connection and proposal interval |
| **Challenger not monitoring** | No dispute monitoring logs | Check network parameter and L1/L2 RPC connections |

## Next steps

*   **Join the Superchain**: Learn about [Superchain compatibility](/superchain/superchain-explainer)
*   **Deploy to mainnet**: Follow the [mainnet deployment guide](/operators/chain-operators/deploy/overview)
*   **Add features**: Explore [OP Stack features](/stack/features) you can enable
*   **Community support**: Join the [Optimism Discord](https://discord.gg/optimism) for help
